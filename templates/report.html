{% extends 'base.html' %}

{% block title %}Reports - Inventory Management System{% endblock %}

{% block breadcrumbs %}
<li aria-current="page">
    <div class="flex items-center">
        <i class="fas fa-chevron-right text-gray-400 mx-1"></i>
        <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2">Reports</span>
    </div>
</li>
{% endblock %}

{% block page_title %}Reports{% endblock %}
{% block page_subtitle %}Generate and view inventory reports{% endblock %}

{% block extra_css %}
<style>
    .chart-container {
        position: relative;
        height: 300px;
        width: 100%;
    }
    
    .report-card {
        transition: all 0.2s ease-in-out;
    }
    
    .report-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
</style>
{% endblock %}

{% block content %}
<div x-data="{ activeTab: 'overview', dateRange: '30' }">
    <!-- Report Controls -->
    <div class="bg-white p-4 border-b border-gray-200">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center space-y-4 md:space-y-0">
            <!-- Tab Navigation -->
            <div class="flex space-x-1 rounded-lg bg-gray-100 p-1">
                <button @click="activeTab = 'overview'" :class="{'bg-white shadow-sm': activeTab === 'overview', 'text-gray-500 hover:text-gray-700': activeTab !== 'overview'}" class="px-4 py-2 text-sm font-medium rounded-md">
                    Overview
                </button>
                <button @click="activeTab = 'inventory'" :class="{'bg-white shadow-sm': activeTab === 'inventory', 'text-gray-500 hover:text-gray-700': activeTab !== 'inventory'}" class="px-4 py-2 text-sm font-medium rounded-md">
                    Inventory
                </button>
                <button @click="activeTab = 'sales'" :class="{'bg-white shadow-sm': activeTab === 'sales', 'text-gray-500 hover:text-gray-700': activeTab !== 'sales'}" class="px-4 py-2 text-sm font-medium rounded-md">
                    Sales
                </button>
                <button @click="activeTab = 'custom'" :class="{'bg-white shadow-sm': activeTab === 'custom', 'text-gray-500 hover:text-gray-700': activeTab !== 'custom'}" class="px-4 py-2 text-sm font-medium rounded-md">
                    Custom
                </button>
            </div>
            
            <!-- Date Range and Export -->
            <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 w-full md:w-auto">
                <select x-model="dateRange" class="rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500">
                    <option value="7">Last 7 days</option>
                    <option value="30">Last 30 days</option>
                    <option value="90">Last 90 days</option>
                    <option value="365">Last year</option>
                    <option value="custom">Custom range</option>
                </select>
                
                <div x-show="dateRange === 'custom'" class="flex space-x-2">
                    <input type="date" id="date_from" name="date_from" class="rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500">
                    <input type="date" id="date_to" name="date_to" class="rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500">
                </div>
                
                <div class="flex space-x-2">
                    <button class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                        <i class="fas fa-sync-alt mr-2"></i> Refresh
                    </button>
                    <div class="relative" x-data="{ open: false }">
                        <button @click="open = !open" class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            <i class="fas fa-download mr-2"></i> Export
                            <i class="fas fa-chevron-down ml-2"></i>
                        </button>
                        
                        <div x-show="open" @click.away="open = false" x-cloak
                             class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-10">
                            <div class="py-1">
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                    <i class="fas fa-file-pdf mr-2 text-red-500"></i> Export as PDF
                                </a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                    <i class="fas fa-file-excel mr-2 text-green-500"></i> Export as Excel
                                </a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                    <i class="fas fa-file-csv mr-2 text-blue-500"></i> Export as CSV
                                </a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                    <i class="fas fa-print mr-2 text-gray-500"></i> Print Report
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Overview Tab -->
    <div x-show="activeTab === 'overview'" class="p-6">
        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
            <!-- Total Products Value -->
            <div class="bg-white rounded-lg shadow p-5 border-l-4 border-blue-500">
                <div class="flex justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-500 mb-1">Total Inventory Value</p>
                        <p class="text-3xl font-bold text-gray-800">${{ total_inventory_value|floatformat:2 }}</p>
                    </div>
                    <div class="rounded-full bg-blue-100 p-3">
                        <i class="fas fa-dollar-sign text-blue-500"></i>
                    </div>
                </div>
                <div class="mt-4 text-sm">
                    <span class="text-green-500 font-medium">
                        <i class="fas fa-arrow-up"></i> 8.2%
                    </span>
                    <span class="text-gray-500">since last month</span>
                </div>
            </div>

            <!-- Total Products -->
            <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                <div class="flex justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-500 mb-1">Total Products</p>
                        <p class="text-3xl font-bold text-gray-800">{{ total_products }}</p>
                    </div>
                    <div class="rounded-full bg-green-100 p-3">
                        <i class="fas fa-box text-green-500"></i>
                    </div>
                </div>
                <div class="mt-4 text-sm">
                    <span class="text-green-500 font-medium">
                        <i class="fas fa-arrow-up"></i> 12%
                    </span>
                    <span class="text-gray-500">since last month</span>
                </div>
            </div>

            <!-- Total Sales -->
            <div class="bg-white rounded-lg shadow p-5 border-l-4 border-purple-500">
                <div class="flex justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-500 mb-1">Total Sales</p>
                        <p class="text-3xl font-bold text-gray-800">${{ total_sales|floatformat:2 }}</p>
                    </div>
                    <div class="rounded-full bg-purple-100 p-3">
                        <i class="fas fa-shopping-cart text-purple-500"></i>
                    </div>
                </div>
                <div class="mt-4 text-sm">
                    <span class="text-green-500 font-medium">
                        <i class="fas fa-arrow-up"></i> 5.3%
                    </span>
                    <span class="text-gray-500">since last month</span>
                </div>
            </div>

            <!-- Low Stock Items -->
            <div class="bg-white rounded-lg shadow p-5 border-l-4 border-red-500">
                <div class="flex justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-500 mb-1">Low Stock Items</p>
                        <p class="text-3xl font-bold text-gray-800">{{ low_stock_count }}</p>
                    </div>
                    <div class="rounded-full bg-red-100 p-3">
                        <i class="fas fa-exclamation-triangle text-red-500"></i>
                    </div>
                </div>
                <div class="mt-4 text-sm">
                    <a href="#" class="text-red-500 font-medium hover:underline">
                        View all <i class="fas fa-arrow-right ml-1"></i>
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Charts Row -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- Sales Trend Chart -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-4 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-800">Sales Trend</h3>
                    <p class="text-sm text-gray-500">Last 30 days</p>
                </div>
                <div class="p-4">
                    <div class="chart-container">
                        <canvas id="salesTrendChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Top Categories Chart -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-4 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-800">Inventory by Category</h3>
                    <p class="text-sm text-gray-500">Value distribution</p>
                </div>
                <div class="p-4">
                    <div class="chart-container">
                        <canvas id="categoriesValueChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Available Reports -->
        <h3 class="text-lg font-medium text-gray-800 mb-4">Available Reports</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <!-- Inventory Value Report -->
            <a href="#" class="report-card bg-white p-4 rounded-lg shadow text-center hover:shadow-md transition-shadow">
                <div class="rounded-full bg-blue-100 h-12 w-12 flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-dollar-sign text-blue-500"></i>
                </div>
                <h4 class="text-sm font-medium text-gray-800">Inventory Value Report</h4>
                <p class="text-xs text-gray-500 mt-1">Detailed breakdown of inventory value by product and category</p>
            </a>
            
            <!-- Low Stock Report -->
            <a href="#" class="report-card bg-white p-4 rounded-lg shadow text-center hover:shadow-md transition-shadow">
                <div class="rounded-full bg-red-100 h-12 w-12 flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-exclamation-triangle text-red-500"></i>
                </div>
                <h4 class="text-sm font-medium text-gray-800">Low Stock Report</h4>
                <p class="text-xs text-gray-500 mt-1">Products that need reordering based on minimum stock levels</p>
            </a>
            
            <!-- Sales Report -->
            <a href="#" class="report-card bg-white p-4 rounded-lg shadow text-center hover:shadow-md transition-shadow">
                <div class="rounded-full bg-green-100 h-12 w-12 flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-chart-line text-green-500"></i>
                </div>
                <h4 class="text-sm font-medium text-gray-800">Sales Report</h4>
                <p class="text-xs text-gray-500 mt-1">Detailed sales analysis by product, category, and time period</p>
            </a>
            
            <!-- Product Movement Report -->
            <a href="#" class="report-card bg-white p-4 rounded-lg shadow text-center hover:shadow-md transition-shadow">
                <div class="rounded-full bg-purple-100 h-12 w-12 flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-exchange-alt text-purple-500"></i>
                </div>
                <h4 class="text-sm font-medium text-gray-800">Product Movement Report</h4>
                <p class="text-xs text-gray-500 mt-1">Track stock ins and outs for each product over time</p>
            </a>
            
            <!-- Supplier Performance Report -->
            <a href="#" class="report-card bg-white p-4 rounded-lg shadow text-center hover:shadow-md transition-shadow">
                <div class="rounded-full bg-yellow-100 h-12 w-12 flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-truck text-yellow-500"></i>
                </div>
                <h4 class="text-sm font-medium text-gray-800">Supplier Performance</h4>
                <p class="text-xs text-gray-500 mt-1">Analyze supplier reliability, delivery times, and quality</p>
            </a>
            
            <!-- Custom Report -->
            <a href="#" class="report-card bg-white p-4 rounded-lg shadow text-center hover:shadow-md transition-shadow">
                <div class="rounded-full bg-gray-100 h-12 w-12 flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-cog text-gray-500"></i>
                </div>
                <h4 class="text-sm font-medium text-gray-800">Custom Report</h4>
                <p class="text-xs text-gray-500 mt-1">Build your own custom report with selected metrics and filters</p>
            </a>
        </div>
    </div>
    
    <!-- Inventory Tab -->
    <div x-show="activeTab === 'inventory'" class="p-6">
        <div class="bg-white rounded-lg shadow overflow-hidden mb-6">
            <div class="p-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-800">Inventory Value by Category</h3>
            </div>
            <div class="p-4">
                <div class="chart-container">
                    <canvas id="inventoryCategoryChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow overflow-hidden">
            <div class="p-4 border-b border-gray-200 flex justify-between items-center">
                <h3 class="text-lg font-medium text-gray-800">Top 10 Most Valuable Products</h3>
                <a href="#" class="text-sm text-primary-600 hover:underline">View Full Report</a>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Product
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                SKU
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Category
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Quantity
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Unit Price
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Total Value
                            </th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        {% for product in top_valuable_products %}
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 h-10 w-10 rounded-md bg-gray-200 overflow-hidden">
                                        {% if product.image %}
                                        <img src="{{ product.image.url }}" alt="{{ product.name }}" class="h-10 w-10 object-cover">
                                        {% else %}
                                        <div class="h-10 w-10 flex items-center justify-center">
                                            <i class="fas fa-box text-gray-400"></i>
                                        </div>
                                        {% endif %}
                                    </div>
                                    <div class="ml-4">
                                        <div class="text-sm font-medium text-gray-900">{{ product.name }}</div>
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">{{ product.sku }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-primary-100 text-primary-800">
                                    {{ product.category.name }}
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">{{ product.quantity }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">${{ product.unit_price|floatformat:2 }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm font-medium text-gray-900">${{ product.total_value|floatformat:2 }}</div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Sales Tab -->
    <div x-show="activeTab === 'sales'" class="p-6">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- Monthly Sales Chart -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-4 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-800">Monthly Sales</h3>
                    <p class="text-sm text-gray-500">Last 12 months</p>
                </div>
                <div class="p-4">
                    <div class="chart-container">
                        <canvas id="monthlySalesChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Top Selling Products Chart -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-4 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-800">Top Selling Products</h3>
                    <p class="text-sm text-gray-500">By quantity sold</p>
                </div>
                <div class="p-4">
                    <div class="chart-container">
                        <canvas id="topProductsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow overflow-hidden">
            <div class="p-4 border-b border-gray-200 flex justify-between items-center">
                <h3 class="text-lg font-medium text-gray-800">Recent Sales</h3>
                <a href="#" class="text-sm text-primary-600 hover:underline">View Full Report</a>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Order ID
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Date
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Customer
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Items
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Total
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Status
                            </th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        {% for order in recent_orders %}
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm font-medium text-gray-900">#{{ order.order_number }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">{{ order.date|date:"M d, Y" }}</div>
                                <div class="text-xs text-gray-500">{{ order.date|date:"h:i A" }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">{{ order.customer_name }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">{{ order.items_count }} items</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm font-medium text-gray-900">${{ order.total|floatformat:2 }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                {% if order.status == 'delivered' %}
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                    Delivered
                                </span>
                                {% elif order.status == 'shipped' %}
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-100 text-purple-800">
                                    Shipped
                                </span>
                                {% elif order.status == 'processing' %}
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                                    Processing
                                </span>
                                {% elif order.status == 'pending' %}
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                    Pending
                                </span>
                                {% elif order.status == 'cancelled' %}
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                    Cancelled
                                </span>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Custom Report Tab -->
    <div x-show="activeTab === 'custom'" class="p-6">
        <div class="bg-white rounded-lg shadow overflow-hidden mb-6">
            <div class="p-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-800">Build Custom Report</h3>
                <p class="text-sm text-gray-500">Select metrics and filters to generate a custom report</p>
            </div>
            <div class="p-6">
                <form method="post" action="#">
                    {% csrf_token %}
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <!-- Report Type -->
                        <div>
                            <label for="report_type" class="block text-sm font-medium text-gray-700 mb-1">Report Type</label>
                            <select name="report_type" id="report_type" class="w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500">
                                <option value="inventory">Inventory Report</option>
                                <option value="sales">Sales Report</option>
                                <option value="product_movement">Product Movement Report</option>
                                <option value="supplier">Supplier Report</option>
                            </select>
                        </div>
                        
                        <!-- Date Range -->
                        <div>
                            <label for="date_range" class="block text-sm font-medium text-gray-700 mb-1">Date Range</label>
                            <select name="date_range" id="date_range" class="w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500">
                                <option value="7">Last 7 days</option>
                                <option value="30" selected>Last 30 days</option>
                                <option value="90">Last 90 days</option>
                                <option value="365">Last year</option>
                                <option value="custom">Custom range</option>
                            </select>
                        </div>
                        
                        <!-- Custom Date Range (conditionally shown) -->
                        <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6" id="custom_date_container" style="display: none;">
                            <div>
                                <label for="date_from" class="block text-sm font-medium text-gray-700 mb-1">From Date</label>
                                <input type="date" name="date_from" id="custom_date_from" class="w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500">
                            </div>
                            <div>
                                <label for="date_to" class="block text-sm font-medium text-gray-700 mb-1">To Date</label>
                                <input type="date" name="date_to" id="custom_date_to" class="w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500">
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <!-- Categories -->
                        <div>
                            <label for="categories" class="block text-sm font-medium text-gray-700 mb-1">Categories</label>
                            <select name="categories" id="categories" multiple class="w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500" size="5">
                                <option value="all" selected>All Categories</option>
                                {% for category in categories %}
                                <option value="{{ category.id }}">{{ category.name }}</option>
                                {% endfor %}
                            </select>
                            <p class="mt-1 text-xs text-gray-500">Hold Ctrl/Cmd to select multiple</p>
                        </div>
                        
                        <!-- Suppliers -->
                        <div>
                            <label for="suppliers" class="block text-sm font-medium text-gray-700 mb-1">Suppliers</label>
                            <select name="suppliers" id="suppliers" multiple class="w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500" size="5">
                                <option value="all" selected>All Suppliers</option>
                                {% for supplier in suppliers %}
                                <option value="{{ supplier.id }}">{{ supplier.name }}</option>
                                {% endfor %}
                            </select>
                            <p class="mt-1 text-xs text-gray-500">Hold Ctrl/Cmd to select multiple</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <!-- Metrics -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Metrics to Include</label>
                            <div class="space-y-2">
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="metric_quantity" name="metrics[]" value="quantity" type="checkbox" checked class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="metric_quantity" class="font-medium text-gray-700">Quantity</label>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="metric_value" name="metrics[]" value="value" type="checkbox" checked class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="metric_value" class="font-medium text-gray-700">Value</label>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="metric_movement" name="metrics[]" value="movement" type="checkbox" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="metric_movement" class="font-medium text-gray-700">Stock Movement</label>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="metric_sales" name="metrics[]" value="sales" type="checkbox" class="rounded border-gray-300 text-primary-600 focus:ring-primary-500">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="metric_sales" class="font-medium text-gray-700">Sales Performance</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Grouping -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Group By</label>
                            <div class="space-y-2">
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="group_product" name="group_by" value="product" type="radio" checked class="rounded-full border-gray-300 text-primary-600 focus:ring-primary-500">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="group_product" class="font-medium text-gray-700">Product</label>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="group_category" name="group_by" value="category" type="radio" class="rounded-full border-gray-300 text-primary-600 focus:ring-primary-500">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="group_category" class="font-medium text-gray-700">Category</label>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="group_supplier" name="group_by" value="supplier" type="radio" class="rounded-full border-gray-300 text-primary-600 focus:ring-primary-500">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="group_supplier" class="font-medium text-gray-700">Supplier</label>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="group_date" name="group_by" value="date" type="radio" class="rounded-full border-gray-300 text-primary-600 focus:ring-primary-500">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="group_date" class="font-medium text-gray-700">Date</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Chart Type -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Chart Type</label>
                        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="relative">
                                <input type="radio" id="chart_bar" name="chart_type" value="bar" class="sr-only peer" checked>
                                <label for="chart_bar" class="flex flex-col items-center p-4 border rounded-lg cursor-pointer peer-checked:border-primary-500 peer-checked:bg-primary-50 hover:bg-gray-50">
                                    <i class="fas fa-chart-bar text-2xl mb-2 text-gray-500 peer-checked:text-primary-600"></i>
                                    <span class="text-sm font-medium">Bar Chart</span>
                                </label>
                            </div>
                            <div class="relative">
                                <input type="radio" id="chart_line" name="chart_type" value="line" class="sr-only peer">
                                <label for="chart_line" class="flex flex-col items-center p-4 border rounded-lg cursor-pointer peer-checked:border-primary-500 peer-checked:bg-primary-50 hover:bg-gray-50">
                                    <i class="fas fa-chart-line text-2xl mb-2 text-gray-500 peer-checked:text-primary-600"></i>
                                    <span class="text-sm font-medium">Line Chart</span>
                                </label>
                            </div>
                            <div class="relative">
                                <input type="radio" id="chart_pie" name="chart_type" value="pie" class="sr-only peer">
                                <label for="chart_pie" class="flex flex-col items-center p-4 border rounded-lg cursor-pointer peer-checked:border-primary-500 peer-checked:bg-primary-50 hover:bg-gray-50">
                                    <i class="fas fa-chart-pie text-2xl mb-2 text-gray-500 peer-checked:text-primary-600"></i>
                                    <span class="text-sm font-medium">Pie Chart</span>
                                </label>
                            </div>
                            <div class="relative">
                                <input type="radio" id="chart_table" name="chart_type" value="table" class="sr-only peer">
                                <label for="chart_table" class="flex flex-col items-center p-4 border rounded-lg cursor-pointer peer-checked:border-primary-500 peer-checked:bg-primary-50 hover:bg-gray-50">
                                    <i class="fas fa-table text-2xl mb-2 text-gray-500 peer-checked:text-primary-600"></i>
                                    <span class="text-sm font-medium">Table Only</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Form Actions -->
                    <div class="flex justify-end space-x-3">
                        <button type="reset" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            Reset
                        </button>
                        <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            Generate Report
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Date range handling for custom report
        const dateRange = document.getElementById('date_range');
        const customDateContainer = document.getElementById('custom_date_container');
        
        if (dateRange) {
            dateRange.addEventListener('change', function() {
                if (this.value === 'custom') {
                    customDateContainer.style.display = 'grid';
                } else {
                    customDateContainer.style.display = 'none';
                }
            });
        }
        
        // Sales Trend Chart
        const salesCtx = document.getElementById('salesTrendChart');
        if (salesCtx) {
            const salesChart = new Chart(salesCtx, {
                type: 'line',
                data: {
                    labels: ['May 1', 'May 5', 'May 10', 'May 15', 'May 20', 'May 25', 'May 30'],
                    datasets: [{
                        label: 'Sales',
                        data: [1200, 1900, 1500, 2500, 2200, 3000, 3400],
                        borderColor: '#0ea5e9',
                        backgroundColor: 'rgba(14, 165, 233, 0.1)',
                        borderWidth: 2,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Categories Value Chart
        const categoriesCtx = document.getElementById('categoriesValueChart');
        if (categoriesCtx) {
            const categoriesChart = new Chart(categoriesCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Electronics', 'Furniture', 'Clothing', 'Books', 'Others'],
                    datasets: [{
                        data: [12000, 8000, 5000, 3000, 2000],
                        backgroundColor: [
                            '#3B82F6',
                            '#10B981',
                            '#F59E0B',
                            '#8B5CF6',
                            '#6B7280'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: $${value} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Inventory Category Chart
        const inventoryCategoryCtx = document.getElementById('inventoryCategoryChart');
        if (inventoryCategoryCtx) {
            const inventoryCategoryChart = new Chart(inventoryCategoryCtx, {
                type: 'bar',
                data: {
                    labels: ['Electronics', 'Furniture', 'Clothing', 'Books', 'Others'],
                    datasets: [{
                        label: 'Inventory Value',
                        data: [12000, 8000, 5000, 3000, 2000],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.7)',
                            'rgba(16, 185, 129, 0.7)',
                            'rgba(245, 158, 11, 0.7)',
                            'rgba(139, 92, 246, 0.7)',
                            'rgba(107, 114, 128, 0.7)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(16, 185, 129)',
                            'rgb(245, 158, 11)',
                            'rgb(139, 92, 246)',
                            'rgb(107, 114, 128)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Inventory Value: $${context.raw}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Monthly Sales Chart
        const monthlySalesCtx = document.getElementById('monthlySalesChart');
        if (monthlySalesCtx) {
            const monthlySalesChart = new Chart(monthlySalesCtx, {
                type: 'bar',
                data: {
                    labels: ['Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr', 'May'],
                    datasets: [{
                        label: 'Sales',
                        data: [6500, 5900, 8000, 8100, 9600, 12000, 15000, 10000, 9500, 11000, 12500, 14000],
                        backgroundColor: 'rgba(14, 165, 233, 0.7)',
                        borderColor: 'rgb(14, 165, 233)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Sales: $${context.raw}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Top Products Chart
        const topProductsCtx = document.getElementById('topProductsChart');
        if (topProductsCtx) {
            const topProductsChart = new Chart(topProductsCtx, {
                type: 'horizontalBar',
                data: {
                    labels: ['Laptop HP 15', 'Wireless Mouse', 'Office Chair', 'Desk Lamp', 'USB-C Cable'],
                    datasets: [{
                        label: 'Units Sold',
                        data: [120, 95, 80, 75, 65],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.7)',
                            'rgba(16, 185, 129, 0.7)',
                            'rgba(245, 158, 11, 0.7)',
                            'rgba(139, 92, 246, 0.7)',
                            'rgba(107, 114, 128, 0.7)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(16, 185, 129)',
                            'rgb(245, 158, 11)',
                            'rgb(139, 92, 246)',
                            'rgb(107, 114, 128)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
    });
</script>
{% endblock %}
